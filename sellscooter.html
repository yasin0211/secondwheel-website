<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sell Scooter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>
  <h2>Sell Your Scooter</h2>

  <form id="sellScooterForm">
    <label>Full Name</label>
    <input type="text" name="Name" required />

    <label>Mobile</label>
    <input type="tel" name="Phone" required />

    <label>City</label>
    <input type="text" name="City" required />

    <label>Vehicle Number</label>
    <input type="text" name="VehicleNumber" required />

    <label>Brand</label>
    <input type="text" name="Brand" required />

    <label>Model</label>
    <input type="text" name="Model" required />

    <label>Year</label>
    <input type="number" name="Year" required />

    <label>Color</label>
    <input type="text" name="Color" required />

    <label>RC Renewed?</label>
    <select name="RC">
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>

    <label>Insurance Valid?</label>
    <select name="Insurance">
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>

    <label>Insurance Type</label>
    <select name="InsuranceType">
      <option>Third Party</option>
      <option>Comprehensive</option>
      <option>Not Sure</option>
    </select>

    <label>PUC Available?</label>
    <select name="PUC">
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>

    <label>Upload RC Book</label>
    <input type="file" name="RCBook" id="rcBook" />

    <label><input type="checkbox" name="Doorstep" id="doorstep" /> I want Doorstep Valuation</label>

    <button type="submit">Submit</button>
  </form>

  <script>
    document.getElementById("sellScooterForm").addEventListener("submit", function (e) {
      const doorstep = document.getElementById("doorstep").checked;
      const rcFile = document.getElementById("rcBook").files.length;

      if (doorstep && rcFile === 0) {
        e.preventDefault();
        alert("Please upload RC Book for doorstep valuation.");
        return;
      }

      // Gather form data
      const formData = new FormData(this);
      const plainData = {};
      formData.forEach((value, key) => {
        plainData[key] = value;
      });

      // Send data to Google Sheet
      fetch("https://script.google.com/macros/s/AKfycbwxnMrS0zNPgeLNjA7rg_FCx1OtAb1VM-Za_J3oI8Dwqp46pY-WZmWG7KzdzL65l-ne/exec", {
        method: "POST",
        body: JSON.stringify(plainData),
        headers: {
          "Content-Type": "application/json",
        },
      })
      .then((res) => res.text())
      .then((data) => {
        alert("Form submitted successfully!");
        document.getElementById("sellScooterForm").reset();
      })
      .catch((err) => {
        alert("Error submitting form. Please try again.");
        console.error(err);
      });

      e.preventDefault(); // Prevent default form submit
    });
  </script>
</body>
</html>
