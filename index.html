<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SecondWheel.in ‚Äì Trusted Vehicles, Smart Deals</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Supabase v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Noto Sans',sans-serif;background:#f5f7fb;color:#142033;line-height:1.45}
    header{background:#0a2c5f;color:#fff;text-align:center;padding:18px}
    header img{height:48px}
    header h1{font-size:1.15rem;margin-top:8px}
    nav{position:sticky;top:0;z-index:50;display:flex;gap:4px;justify-content:center;background:#0f356e;padding:6px 8px}
    nav button{padding:10px 14px;border:none;background:transparent;color:#fff;font-weight:700;cursor:pointer;border-radius:8px}
    nav button.active{background:#1b4fa0}
    .container{max-width:1100px;margin:18px auto;padding:0 14px}
    .section{display:none;background:#fff;border:1px solid #e6ebf2;border-radius:14px;padding:22px;box-shadow:0 6px 18px rgba(23,29,40,.06);margin-bottom:18px}
    .section.active{display:block}
    h2{color:#0a2c5f;margin:6px 0 12px}
    .gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:16px}
    .card{background:#fff;border:1px solid #e8ebf3;border-radius:12px;overflow:hidden}
    .card img{width:100%;height:150px;object-fit:cover;background:#eef2f7}
    .card .meta{padding:10px}
    footer{text-align:center;padding:14px;color:#fff;background:#0a2c5f;border-radius:12px}
    .sticky{position:fixed;left:50%;transform:translateX(-50%);bottom:12px;display:flex;gap:10px;z-index:60}
    .sticky a{background:#25D366;color:#fff;padding:12px 16px;border-radius:999px;text-decoration:none;font-weight:700}
    a.link{color:#ffe6b3;text-decoration:none}
    @media (max-width:480px){.gallery{grid-template-columns:1fr 1fr}}
    .btn{background:#0a2c5f;color:#fff;border:none;border-radius:10px;padding:10px 14px;cursor:pointer}
    .btn.secondary{background:#ff7a00}
    input,select,textarea{padding:10px;border-radius:8px;border:1px solid #cfd6e4}
  </style>
</head>
<body>

  <header>
    <!-- ‡§§‡•Å‡§Æ‡§ö‡§æ final ‡§≤‡•ã‡§ó‡•ã URL -->
    <img src="assets/logo-yellow-metallic.png" alt="Second Wheel Logo" onerror="this.src='https://placehold.co/220x48?text=SECOND+WHEEL'">
    <h1>Trusted Vehicles, Smart Deals</h1>
  </header>

  <nav>
    <button onclick="showSection('home')" id="homeTab" class="active">Home</button>
    <button onclick="showSection('buy')" id="buyTab">Buy</button>
    <button onclick="showSection('featured')" id="featuredTab">Featured</button>
    <button onclick="showSection('sell')" id="sellTab">Sell</button>
    <button onclick="showSection('services')" id="servicesTab">Tools</button>
  </nav>

  <div class="container">
    <!-- HOME -->
    <section id="home" class="section active">
      <h2>Featured Cars</h2>
      <div id="homeFeat" class="gallery"></div>
    </section>

    <!-- BUY -->
    <section id="buy" class="section">
      <h2>Buy Vehicles</h2>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin:8px 0">
        <button class="btn" onclick="setBuyType('car')">Cars</button>
        <button class="btn secondary" onclick="setBuyType('bike')">Bikes</button>
        <input id="brandFilter" placeholder="Filter by brand" oninput="renderBuy()" style="flex:1 1 240px">
        <select id="cityFilter" onchange="renderBuy()">
          <option value="">All Cities</option>
          <option>Pune</option><option>Mumbai</option><option>Nashik</option><option>Satara</option>
        </select>
      </div>
      <div id="buyGrid" class="gallery"></div>
    </section>

    <!-- FEATURED PAGE -->
    <section id="featured" class="section">
      <h2>üöó Featured Cars</h2>
      <div id="featCars" class="gallery"></div>
      <h2 style="margin-top:14px">üèçÔ∏è Featured Bikes</h2>
      <div id="featBikes" class="gallery"></div>
    </section>

    <!-- SELL -->
    <section id="sell" class="section">
      <h2>Sell Your Vehicle</h2>
      <form id="sellForm">
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin:8px 0">
          <select id="vType" required>
            <option disabled selected value="">Vehicle Type</option>
            <option>Car</option><option>Bike</option>
          </select>
          <input id="brand" placeholder="Brand" required />
          <input id="model" placeholder="Model" required />
          <input id="year" type="number" placeholder="Year" required />
          <input id="km" placeholder="KM Driven" required />
          <input id="city" placeholder="City" required />
          <input id="mobile" type="tel" placeholder="Mobile (10 digits)" required />
        </div>
        <textarea id="notes" placeholder="Additional Notes" style="width:100%;margin-top:8px"></textarea>
        <div style="display:flex;justify-content:flex-end;margin-top:8px">
          <button type="submit" class="btn">Submit</button>
        </div>
      </form>
    </section>

    <!-- TOOLS -->
    <section id="services" class="section">
      <h2>Online Tools</h2>
      <p>Insurance, FASTag, RTO, HSRP ‡§Ü‡§£‡§ø ‡§á‡§§‡§∞ links ‡§™‡•Å‡§¢‡§ö‡•ç‡§Ø‡§æ update ‡§Æ‡§ß‡•ç‡§Ø‡•á add ‡§ï‡§∞‡•Ç.</p>
    </section>

    <footer>
      ¬© 2025 SecondWheel.in ‚Ä¢ 
      <a class="link" href="mailto:sales@secondwheel.in">sales@secondwheel.in</a>
    </footer>
  </div>

  <!-- WhatsApp -->
  <div class="sticky">
    <a href="https://wa.me/919822292955" target="_blank">WhatsApp</a>
  </div>

  <script>
    // Supabase init
    const SUPABASE_URL = "https://wbjwvxckbfkutqqbgupq.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indiand2eGNrYmZrdXRxcWJndXBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NzU3NDEsImV4cCI6MjA2OTQ1MTc0MX0.u_zwikgAryhF5Ccv5yOvjq20hzxE5tbYfKI04uTnNXw";
    const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    // Home featured cars
    async function loadHomeFeatured(){
      const wrap = document.getElementById('homeFeat');
      wrap.innerHTML = "";
      const { data, error } = await sb
        .from("vehicles")
        .select("*")
        .eq("featured", true)
        .eq("type","car")
        .order("created_at",{ascending:false})
        .limit(6);
      if(error){ console.error(error); }
      if(!data || !data.length){ renderStaticHome(); return; }
      renderCards(data, wrap);
    }

    function renderStaticHome(){
      const wrap = document.getElementById('homeFeat');
      wrap.innerHTML = `
        <div class="card">
          <img src="https://placehold.co/400x240?text=Alto+K10+2011" alt="Alto K10 LXI">
          <div class="meta">
            <b>Maruti Suzuki Alto K10 LXI</b><br>
            ‚Çπ1,45,000 ‚Ä¢ Satara<br>
            <small>2011 ‚Ä¢ 67,000 KM</small>
          </div>
        </div>
        <div class="card">
          <img src="https://placehold.co/400x240?text=i20+Sportz+2016" alt="Hyundai i20 Sportz">
          <div class="meta">
            <b>Hyundai i20 Sportz</b><br>
            ‚Çπ5,10,000 ‚Ä¢ Satara<br>
            <small>2016 ‚Ä¢ 88,000 KM</small>
          </div>
        </div>
        <div class="card">
          <img src="https://placehold.co/400x240?text=Swift+Dzire+2013" alt="Swift Dzire VXI">
          <div class="meta">
            <b>Maruti Suzuki Swift Dzire VXI</b><br>
            ‚Çπ4,80,000 ‚Ä¢ Satara<br>
            <small>2013 ‚Ä¢ 69,000 KM</small>
          </div>
        </div>
      `;
    }

    // Featured page
    async function loadFeatured(){
      const { data, error } = await sb
        .from("vehicles")
        .select("*")
        .eq("featured", true)
        .order("created_at",{ascending:false})
        .limit(40);
      if(error){ console.error(error); return; }
      renderCards(data.filter(x=>x.type==='car'), document.getElementById("featCars"));
      renderCards(data.filter(x=>x.type==='bike'), document.getElementById("featBikes"));
    }

    // Buy
    let buyType = 'car';
    function setBuyType(t){ buyType=t; renderBuy(); }
    async function renderBuy(){
      const brandQ = document.getElementById('brandFilter').value.trim();
      const cityQ = document.getElementById('cityFilter').value;
      let q = sb.from("vehicles").select("*").eq("type", buyType).order("created_at",{ascending:false}).limit(60);
      if(brandQ) q = q.ilike("brand", `%${brandQ}%`);
      if(cityQ) q = q.eq("city", cityQ);
      const { data, error } = await q;
      if(error){ console.error(error); return; }
      renderCards(data, document.getElementById("buyGrid"));
    }

    // Render cards
    function renderCards(list, mount){
      mount.innerHTML = (list||[]).map(v => `
        <div class="card">
          <img src="${v.image || 'https://placehold.co/400x240?text=Vehicle'}" alt="${v.title||''}" />
          <div class="meta">
            <b>${v.title || (v.brand+' '+v.model)}</b><br/>
            ‚Çπ${Number(v.price||0).toLocaleString('en-IN')} ‚Ä¢ ${v.city||''}<br/>
            <small>${v.year||''} ‚Ä¢ ${v.km||''} KM</small>
          </div>
        </div>
      `).join('');
    }

    // Sell form
    document.getElementById("sellForm").addEventListener("submit", async (e)=>{
      e.preventDefault();
      const mobile = document.getElementById('mobile').value || '';
      if(mobile.replace(/\D/g,'').length!==10){ alert("Enter 10-digit mobile"); return; }
      const payload = {
        type: document.getElementById('vType').value.toLowerCase(),
        brand: brand.value, model: model.value, year: +year.value,
        km: km.value, city: city.value, mobile, notes: notes.value || "",
        title: brand.value+" "+model.value, price: null, image: null, featured: false
      };
      const { error } = await sb.from("sell_leads").insert(payload);
      if(error){ alert("Error saving form."); console.error(error); }
      else{ alert("Submitted! We will contact you soon."); e.target.reset(); }
    });

    // Navigation
    function showSection(id){
      document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
      document.getElementById(id+'Tab')?.classList.add('active');
      if(id==='featured') loadFeatured();
      if(id==='buy') renderBuy();
      if(id==='home') loadHomeFeatured();
    }

    // Initial
    loadHomeFeatured();
  </script>
</body>
</html>
