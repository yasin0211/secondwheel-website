<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Second Wheel ‚Äì Trusted Vehicles, Smart Deals</title>
<meta name="theme-color" content="#0b0f17"/>
<style>
  :root{
    --bg:#0b0f17; --panel:#0f1522; --card:#121826; --ink:#e5e7eb; --muted:#9aa3b2;
    --line:rgba(255,255,255,.10); --brand:#f59e0b; --brand2:#f97316;
    --ok:#22c55e; --err:#ef4444; --shadow:0 10px 30px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial}
  a{color:inherit;text-decoration:none}
  img{max-width:100%;display:block}
  .container{max-width:1160px;margin:0 auto;padding:16px}
  /* Header/Hero (look like your screenshot #2) */
  header{position:sticky;top:0;z-index:50;background:rgba(11,15,23,.72);backdrop-filter:blur(12px);border-bottom:1px solid var(--line)}
  .top{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:8px 0}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:48px;height:48px;border-radius:12px;overflow:hidden;box-shadow:var(--shadow);background:#09101c}
  .brand h1{margin:0;font-size:18px;letter-spacing:.4px}
  .seg{display:inline-flex;border:1px solid var(--line);border-radius:999px;overflow:hidden}
  .seg button{padding:8px 12px;border:0;background:transparent;color:var(--ink);cursor:pointer}
  .seg button.active{background:rgba(255,255,255,.14)}
  .iconbtn{border:1px solid var(--line);background:rgba(255,255,255,.06);border-radius:12px;padding:8px 10px;cursor:pointer}
  .hero-buttons{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:10px}
  .cta{padding:14px;border-radius:16px;background:linear-gradient(180deg,#f59e0b,#b45309);color:#111;text-align:center;font-weight:800;border:0}
  .cta.ghost{background:rgba(255,255,255,.06);color:var(--ink);border:1px solid var(--line);font-weight:600}
  /* Sections */
  h2{margin:0 0 10px}
  .section{margin:18px 0}
  /* Featured row */
  .cards{display:grid;grid-template-columns:1fr;gap:14px}
  @media(min-width:720px){.cards{grid-template-columns:repeat(2,1fr)}}
  @media(min-width:1020px){.cards{grid-template-columns:repeat(3,1fr)}}
  .card{background:var(--card);border:1px solid var(--line);border-radius:18px;box-shadow:var(--shadow);overflow:hidden}
  .media{position:relative;background:#0a111c}
  .media img{width:100%;height:220px;object-fit:cover}
  .tag{position:absolute;left:10px;top:10px;background:var(--brand);color:#111;font-weight:800;padding:4px 8px;border-radius:999px}
  .body{padding:12px}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .title{font-weight:800;margin:4px 0}
  .muted{color:var(--muted)}
  .actions{display:flex;gap:10px;margin-top:10px}
  .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.06);cursor:pointer}
  .btn.primary{background:linear-gradient(180deg,#f59e0b,#b45309);border:0;color:#111;font-weight:800}
  .btn.heart.active{border-color:transparent;background:rgba(34,197,94,.2);color:var(--ok)}
  /* Tools grid */
  .toolgrid{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:720px){.toolgrid{grid-template-columns:repeat(2,1fr)}}
  @media(min-width:1020px){.toolgrid{grid-template-columns:repeat(3,1fr)}}
  .tool{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:14px}
  .tool h3{margin:2px 0 4px}
  /* Footer */
  footer{border-top:1px solid var(--line);background:#0c121e}
  footer .cols{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
  @media(min-width:720px){footer .cols{grid-template-columns:repeat(4,1fr)}}
  footer a{display:block;color:#cbd5e1;padding:6px 0}
  /* WhatsApp floater */
  .wa{position:fixed;right:16px;bottom:18px;z-index:60}
  .wa a{display:flex;align-items:center;gap:8px;background:#25D366;color:#111;padding:12px 16px;border-radius:999px;box-shadow:var(--shadow);font-weight:800}
  /* Toast */
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:16px;background:#111827;color:#e5e7eb;border:1px solid var(--line);padding:10px 14px;border-radius:10px;box-shadow:var(--shadow);opacity:0;pointer-events:none;transition:opacity .25s}
  .toast.show{opacity:1}
</style>
</head>
<body>
<header>
  <div class="container top">
    <div class="brand">
      <div class="logo">
        <img src="https://wbjwvxckbfkutqqbgupq.supabase.co/storage/v1/object/public/vehicals/logo.png" alt="Second Wheel logo" width="48" height="48" loading="eager">
      </div>
      <div>
        <h1>SECOND WHEEL</h1>
        <div class="muted" data-i18n="tagline">Trusted Vehicles, Smart Deals</div>
      </div>
    </div>
    <div class="row">
      <div id="langSeg" class="seg" aria-label="Language">
        <button data-lang="en" class="active">EN</button>
        <button data-lang="hi">HI</button>
        <button data-lang="mr">MR</button>
      </div>
      <button id="darkBtn" class="iconbtn" title="Toggle dark">üåô</button>
    </div>
  </div>
</header>

<!-- HERO buttons under the logo -->
<section class="container" style="margin-top:8px">
  <div class="hero-buttons">
    <a class="cta" href="buy.html" data-i18n="btn.buy">Buy</a>
    <a class="cta ghost" href="sell.html" data-i18n="btn.sell">Sell</a>
    <a class="cta ghost" href="valuation.html" data-i18n="btn.valuation">Valuation</a>
    <a class="cta ghost" href="tools.html" data-i18n="btn.tools">Tools</a>
  </div>
</section>

<!-- FEATURED -->
<main class="container">
  <section class="section" aria-labelledby="featTitle">
    <h2 id="featTitle" data-i18n="featured.title">Featured Vehicles</h2>
    <div id="cards" class="cards" aria-live="polite"></div>
  </section>

  <!-- TOOLS & SERVICES -->
  <section class="section" aria-labelledby="toolsTitle">
    <h2 id="toolsTitle" data-i18n="tools.title">Tools & Services</h2>
    <div class="toolgrid">
      <a class="tool" href="insurance.html">
        <h3 data-i18n="tools.ins">Insurance</h3><div class="muted" data-i18n="tools.ins.sub">Buy / Renew</div>
      </a>
      <a class="tool" href="tools.html#fastag">
        <h3>FASTag</h3><div class="muted" data-i18n="tools.fastag.sub">Recharge or Buy</div>
      </a>
      <a class="tool" href="valuation.html">
        <h3 data-i18n="btn.valuation">Valuation</h3><div class="muted" data-i18n="tools.val.sub">Instant estimate</div>
      </a>
      <a class="tool" href="https://hsrpmhzone2.in/" target="_blank" rel="noopener">
        <h3>HSRP Plate</h3><div class="muted">Official portal</div>
      </a>
      <a class="tool" href="https://mahatrafficechallan.gov.in/" target="_blank" rel="noopener">
        <h3>Challan Payment</h3><div class="muted">Maharashtra</div>
      </a>
    </div>
  </section>
</main>

<!-- WHATSAPP -->
<div class="wa"><a href="https://wa.me/919822292955" target="_blank" rel="noopener">WhatsApp</a></div>
<div id="toast" class="toast">Saved!</div>

<!-- FOOTER -->
<footer>
  <div class="container">
    <div class="cols" style="padding:20px 0 8px">
      <div>
        <h3>Second Wheel</h3>
        <p class="muted" data-i18n="tagline">Trusted Vehicles, Smart Deals</p>
      </div>
      <div>
        <h4>Company</h4>
        <a href="about.html">About Us</a>
        <a href="contact.html">Contact Us</a>
      </div>
      <div>
        <h4>Legal</h4>
        <a href="terms.html">Terms & Conditions</a>
        <a href="privacy.html">Privacy Policy</a>
        <a href="disclaimer.html">Disclaimer</a>
      </div>
      <div>
        <h4>Follow</h4>
        <a href="#">Instagram</a>
        <a href="#">Facebook</a>
      </div>
    </div>
    <div class="muted" style="padding:8px 0 22px">¬© <span id="yr"></span> Second Wheel ‚Äì All rights reserved.</div>
  </div>
</footer>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  // ---------------- CONFIG ----------------
  const SUPABASE_URL = 'https://wbjwvxckbfkutqqbgupq.supabase.co';
  const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indiand2eGNrYmZrdXRxcWJndXBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NzU3NDEsImV4cCI6MjA2OTQ1MTc0MX0.u_zwikgAryhF5Ccv5yOvjq20hzxE5tbYfKI04uTnNXw';
  const BUCKET = 'vehicals';
  const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  // --------------- i18n -------------------
  const I18N = {
    en:{ 'tagline':'Trusted Vehicles, Smart Deals',
         'btn.buy':'Buy','btn.sell':'Sell','btn.valuation':'Valuation','btn.tools':'Tools',
         'featured.title':'Featured Vehicles',
         'tools.title':'Tools & Services','tools.ins':'Insurance','tools.ins.sub':'Buy / Renew',
         'tools.fastag.sub':'Recharge or Buy','tools.val.sub':'Instant estimate',
         'card.featured':'Featured','card.km':'km','card.wh':'Wishlist','card.enq':'Enquire Now'
       },
    hi:{ 'tagline':'‡§ü‡•ç‡§∞‡§∏‡•ç‡§ü‡•á‡§° ‡§µ‡•ç‡§π‡•Ä‡§ï‡§≤‡•ç‡§∏, ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§°‡•Ä‡§≤‡•ç‡§∏',
         'btn.buy':'‡§ñ‡§∞‡•Ä‡§¶‡•á‡§Ç','btn.sell':'‡§¨‡•á‡§ö‡•á‡§Ç','btn.valuation':'‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç‡§è‡§∂‡§®','btn.tools':'‡§ü‡•Ç‡§≤‡•ç‡§∏',
         'featured.title':'‡§´‡§º‡•Ä‡§ö‡§∞‡•ç‡§° ‡§µ‡§æ‡§π‡§®',
         'tools.title':'‡§ü‡•Ç‡§≤‡•ç‡§∏ ‡§î‡§∞ ‡§∏‡•á‡§µ‡§æ‡§è‡§Å','tools.ins':'‡§¨‡•Ä‡§Æ‡§æ','tools.ins.sub':'‡§ñ‡§∞‡•Ä‡§¶‡•á‡§Ç / ‡§∞‡§ø‡§®‡•ç‡§Ø‡•Ç',
         'tools.fastag.sub':'‡§∞‡§ø‡§ö‡§æ‡§∞‡•ç‡§ú ‡§Ø‡§æ ‡§ñ‡§∞‡•Ä‡§¶‡•á‡§Ç','tools.val.sub':'‡§§‡•Å‡§∞‡§Ç‡§§ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®',
         'card.featured':'‡§´‡§º‡•Ä‡§ö‡§∞‡•ç‡§°','card.km':'‡§ï‡§ø‡§Æ‡•Ä','card.wh':'‡§µ‡§ø‡§∂‡§≤‡§ø‡§∏‡•ç‡§ü','card.enq':'‡§á‡§®‡•ç‡§ï‡•ç‡§µ‡§æ‡§Ø‡§∞‡•Ä'
       },
    mr:{ 'tagline':'‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§µ‡•ç‡§π‡•á‡§á‡§ï‡§≤‡•ç‡§∏, ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§°‡•Ä‡§≤‡•ç‡§∏',
         'btn.buy':'‡§ñ‡§∞‡•á‡§¶‡•Ä','btn.sell':'‡§µ‡§ø‡§ï‡•ç‡§∞‡•Ä','btn.valuation':'‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§®','btn.tools':'‡§ü‡•Ç‡§≤‡•ç‡§∏',
         'featured.title':'‡§´‡•Ä‡§ö‡§∞‡•ç‡§° ‡§µ‡§æ‡§π‡§®‡•á',
         'tools.title':'‡§ü‡•Ç‡§≤‡•ç‡§∏ ‡§Ü‡§£‡§ø ‡§∏‡•á‡§µ‡§æ','tools.ins':'‡§á‡§®‡•ç‡§∂‡•Å‡§∞‡§®‡•ç‡§∏','tools.ins.sub':'‡§ñ‡§∞‡•á‡§¶‡•Ä / ‡§®‡•Ç‡§§‡§®‡•Ä‡§ï‡§∞‡§£',
         'tools.fastag.sub':'‡§∞‡§ø‡§ö‡§æ‡§∞‡•ç‡§ú ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§ñ‡§∞‡•á‡§¶‡•Ä','tools.val.sub':'‡§§‡§§‡•ç‡§ï‡§æ‡§≥ ‡§Ö‡§Ç‡§¶‡§æ‡§ú',
         'card.featured':'‡§´‡•Ä‡§ö‡§∞‡•ç‡§°','card.km':'‡§ï‡§ø.‡§Æ‡•Ä.','card.wh':'‡§µ‡§ø‡§∂‡§≤‡§ø‡§∏‡•ç‡§ü','card.enq':'‡§á‡§®‡•ç‡§ï‡•ç‡§µ‡§æ‡§Ø‡§∞‡•Ä'
       }
  };
  const langSeg = document.getElementById('langSeg');
  function setLang(l){
    const dict = I18N[l] || I18N.en;
    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const k = el.getAttribute('data-i18n');
      if(dict[k]) el.textContent = dict[k];
    });
    [...langSeg.querySelectorAll('button')].forEach(b=>b.classList.toggle('active', b.dataset.lang===l));
    localStorage.setItem('lang', l);
  }
  langSeg.addEventListener('click', e=>{
    if(e.target.tagName==='BUTTON'){ setLang(e.target.dataset.lang); }
  });
  setLang(localStorage.getItem('lang')||'en');

  // --------------- Dark mode --------------
  const darkBtn = document.getElementById('darkBtn');
  function applyDark(v){
    document.documentElement.style.colorScheme = v?'dark':'light';
    localStorage.setItem('dw.dark', v?'1':'0');
    darkBtn.textContent = v?'üåô':'‚òÄÔ∏è';
  }
  darkBtn.addEventListener('click', ()=> applyDark(!(localStorage.getItem('dw.dark')==='1')));
  applyDark(localStorage.getItem('dw.dark')==='1');

  // --------------- Utilities --------------
  const $ = sel => document.querySelector(sel);
  const cards = $('#cards');
  const toast = (t)=>{ const el=$('#toast'); el.textContent=t; el.classList.add('show'); clearTimeout(window.__t); window.__t=setTimeout(()=>el.classList.remove('show'),1500); };
  $('#yr').textContent = new Date().getFullYear();

  function publicUrl(path){
    const { data } = sb.storage.from(BUCKET).getPublicUrl(path);
    return data?.publicUrl || `${SUPABASE_URL}/storage/v1/object/public/${path}`;
  }

  // --------------- Featured loader --------
  async function listFeaturedFolders(){
    // list everything under "featured/"
    const { data, error } = await sb.storage.from(BUCKET).list('featured', { limit: 200 });
    if(error){ console.error(error); return []; }
    return (data||[]).filter(x=>x && !x.name.includes('.'));
  }
  async function readMeta(vid){
    const { data, error } = await sb.storage.from(BUCKET).download(`featured/${vid}/meta.json`);
    if(error) return null;
    try{ return JSON.parse(await data.text()); }catch(e){ return null; }
  }
  async function firstImage(vid){
    const { data, error } = await sb.storage.from(BUCKET).list(`featured/${vid}`, { limit:100 });
    if(error) return null;
    const pic = (data||[]).find(o=>/\.(jpe?g|png|webp)$/i.test(o.name));
    return pic ? publicUrl(`featured/${vid}/${pic.name}`) : null;
  }

  function wishKey(vid){ return `sw.wish.${vid}`; }
  function isWished(vid){ return localStorage.getItem(wishKey(vid))==='1'; }
  function toggleWish(btn,vid){
    const now = !isWished(vid);
    localStorage.setItem(wishKey(vid), now?'1':'0');
    btn.classList.toggle('active', now);
    toast(now?'Added to wishlist':'Removed from wishlist');
  }

  function enquiryLink(meta){
    const msg = encodeURIComponent(
      `Hello, I‚Äôm interested in this vehicle:\n`+
      `${meta?.title||meta?.model||'Vehicle'}\n`+
      `Brand: ${meta?.brand||''}\n`+
      `Year: ${meta?.year||''} | KM: ${meta?.km||''}\n`+
      `Price: ${meta?.price||''}\n`+
      `Type: ${meta?.type||''}`
    );
    return `https://wa.me/919822292955?text=${msg}`;
  }

  async function renderFeatured(){
    cards.innerHTML = '<div class="muted">Loading‚Ä¶</div>';
    const folders = await listFeaturedFolders();
    if(!folders.length){ cards.innerHTML = '<div class="muted">No items yet</div>'; return; }

    const items = [];
    for(const f of folders){
      const vid = f.name;
      const meta = await readMeta(vid) || { title: vid, brand:'', price:'', year:'', km:'', type:'car', description:'' };
      const img = await firstImage(vid);
      items.push({ vid, meta, img });
    }

    // newest first by updatedAt if present
    items.sort((a,b)=> (b.meta.updatedAt||'').localeCompare(a.meta.updatedAt||''));

    cards.innerHTML = '';
    for(const {vid, meta, img} of items){
      const c = document.createElement('article');
      c.className = 'card';

      c.innerHTML = `
        <div class="media">
          ${img? `<img loading="lazy" src="${img}" alt="${meta.title||'Vehicle'}">` : `<div style="height:220px;display:grid;place-items:center" class="muted">No image</div>`}
          <span class="tag" data-i18n="card.featured">${I18N[localStorage.getItem('lang')||'en']['card.featured']}</span>
        </div>
        <div class="body">
          <div class="row" style="justify-content:space-between">
            <div>
              <div class="title">${meta.title||''}</div>
              <div class="muted" style="text-transform:uppercase;letter-spacing:.4px">${meta.brand||''}</div>
              <div class="muted">${meta.year||''} ‚Ä¢ ${meta.km||''} ${I18N[localStorage.getItem('lang')||'en']['card.km']}</div>
            </div>
            <div style="font-weight:800">${meta.price||''}</div>
          </div>
          <div style="margin-top:10px">${(meta.description||'').replace(/\n/g,'<br>')}</div>
          <div class="actions">
            <button class="btn heart ${isWished(vid)?'active':''}" aria-pressed="${isWished(vid)?'true':'false'}">‚ù§Ô∏è <span data-i18n="card.wh">${I18N[localStorage.getItem('lang')||'en']['card.wh']}</span></button>
            <a class="btn primary" href="${enquiryLink(meta)}" target="_blank" rel="noopener"><span data-i18n="card.enq">${I18N[localStorage.getItem('lang')||'en']['card.enq']}</span></a>
          </div>
        </div>
      `;
      const heart = c.querySelector('.heart');
      heart.addEventListener('click', ()=> toggleWish(heart, vid));
      cards.appendChild(c);
    }
  }

  renderFeatured();
</script>
</body>
</html>
