<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Second Wheel – Trusted Vehicles, Smart Deals</title>
  <meta name="theme-color" content="#111827"/>
  <style>
    :root{
      --bg:#0b0f17; --panel:#121826; --ink:#e5e7eb; --muted:#9aa3b2;
      --line:rgba(255,255,255,.10); --brand:#f59e0b; --ok:#22c55e;
      --shadow:0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .wrap{max-width:1160px;margin:0 auto;padding:16px}
    .muted{color:var(--muted)}

    /* Header: logo center + controls + big buttons below */
    header{position:sticky;top:0;z-index:30;background:rgba(11,15,23,.78);backdrop-filter:blur(12px);border-bottom:1px solid var(--line)}
    .controls{display:flex;justify-content:flex-end;gap:8px;flex-wrap:wrap;padding-top:8px}
    .seg{display:inline-flex;border:1px solid var(--line);border-radius:999px;overflow:hidden}
    .seg button{border:0;background:transparent;color:var(--ink);padding:8px 12px;cursor:pointer}
    .seg button.active{background:rgba(255,255,255,.15)}
    .toggle{border:1px solid var(--line);border-radius:999px;padding:8px 12px;cursor:pointer;background:rgba(255,255,255,.06)}
    .brand-wrap{display:grid;place-items:center;text-align:center;padding:8px 0 6px}
    .logo{width:min(22vw,100px);height:min(22vw,100px);border-radius:16px;box-shadow:var(--shadow);object-fit:contain;background:#fff}
    h1{margin:8px 0 2px;font-size:20px;letter-spacing:.35px}

    .cta-row{display:flex;justify-content:center;gap:12px;flex-wrap:wrap;padding:12px 0 16px}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:12px 18px;border-radius:14px;border:1px solid var(--line);
         background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));cursor:pointer;font-weight:700}
    .btn-primary{background:linear-gradient(180deg,#f59e0b,#b45309);color:#111;border-color:transparent}
    .btn:active{transform:translateY(1px)}

    /* Sections */
    .section{margin:20px 0}
    .head{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .head h3{margin:0;font-size:18px}

    /* Featured cards */
    .row{display:flex;gap:12px;overflow:auto;scroll-snap-type:x mandatory;padding:2px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow)}
    .veh{min-width:300px;scroll-snap-align:center}
    .veh .media{position:relative;border-radius:16px 16px 0 0;overflow:hidden}
    .veh .media img{width:100%;height:220px;object-fit:cover;background:#0f1522}
    @media(min-width:720px){ .veh .media img{height:220px} }
    .tag{position:absolute;top:10px;left:10px;background:var(--brand);color:#111;padding:4px 8px;border-radius:999px;font-weight:800;font-size:12px}
    .veh .body{padding:12px}
    .veh .title{font-weight:800;margin:6px 0 4px}
    .veh .meta{display:flex;justify-content:space-between;color:#cbd5e1;font-size:12px;margin-bottom:6px}
    .veh .desc{color:#cbd5e1;font-size:13px;margin-top:6px;white-space:normal;overflow:visible}
    .actions{display:flex;gap:8px;margin-top:10px}
    .wish{border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.06)}
    .inq{background:linear-gradient(180deg,#22c55e,#15803d);border-color:transparent;color:#fff}

    /* Tools grid */
    .grid{display:grid;gap:12px;grid-template-columns:repeat(2,1fr)}
    @media(min-width:720px){ .grid{grid-template-columns:repeat(4,1fr)} }
    .tool{padding:14px;text-align:left}

    /* Footer */
    footer{border-top:1px solid var(--line);background:#0c121e;margin-top:24px}
    footer .cols{display:grid;gap:16px;grid-template-columns:repeat(2,1fr)}
    @media(min-width:720px){ footer .cols{grid-template-columns:repeat(4,1fr)} }
    footer h4{margin:10px 0 6px}
    footer a{display:block;padding:6px 0;color:#cbd5e1}

    /* WhatsApp float */
    .wa{position:fixed;right:16px;bottom:18px;z-index:40}
    .wa a{display:flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;background:#25D366;color:#111;font-weight:800;box-shadow:var(--shadow)}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="controls">
        <div class="seg" id="langSeg" aria-label="Language">
          <button data-lang="en" class="active">EN</button>
          <button data-lang="hi">HI</button>
          <button data-lang="mr">MR</button>
        </div>
        <button id="darkBtn" class="toggle" aria-label="Dark mode">🌙</button>
      </div>
      <div class="brand-wrap">
        <img class="logo" src="https://wbjwvxckbfkutqqbgupq.supabase.co/storage/v1/object/public/vehicals/logo.png" alt="Second Wheel logo">
        <h1>SECOND WHEEL</h1>
        <div class="muted">Trusted Vehicles, Smart Deals</div>
      </div>
      <!-- Stylish buttons under logo -->
      <nav class="cta-row" aria-label="Primary">
        <a class="btn btn-primary" href="index.html" data-i18n="nav.home">Home</a>
        <a class="btn btn-primary" href="buy.html" data-i18n="nav.buy">Buy</a>
        <a class="btn btn-primary" href="sell.html" data-i18n="nav.sell">Sell</a>
        <a class="btn btn-primary" href="valuation.html" data-i18n="nav.valuation">Valuation</a>
        <a class="btn btn-primary" href="tools.html" data-i18n="nav.tools">Tools</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- FEATURED -->
    <section class="section" aria-labelledby="featHead">
      <div class="head">
        <h3 id="featHead" data-i18n="feat.title">Featured Vehicles</h3>
        <a class="btn" href="buy.html" data-i18n="feat.viewall">View all</a>
      </div>
      <div id="featuredRow" class="row" aria-live="polite"></div>
    </section>

    <!-- TOOLS & SERVICES -->
    <section class="section" aria-labelledby="toolsHead">
      <div class="head"><h3 id="toolsHead" data-i18n="tools.title">Tools & Services</h3></div>
      <div class="grid">
        <a class="card tool" href="https://hsrpmhzone2.in/" target="_blank" rel="noopener">
          <strong>HSRP Booking</strong><div class="muted">Official MH portal</div>
        </a>
        <a class="card tool" href="https://mahatrafficechallan.gov.in/" target="_blank" rel="noopener">
          <strong>Pay Challan</strong><div class="muted">Maharashtra e-challan</div>
        </a>
        <a class="card tool" href="insurance.html">
          <strong>Insurance</strong><div class="muted">Buy / Renew</div>
        </a>
        <a class="card tool" href="tools.html#fastag">
          <strong>FASTag</strong><div class="muted">Buy / Recharge</div>
        </a>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="wrap">
      <div class="cols" style="padding:20px 0 8px">
        <div>
          <h4>Second Wheel</h4>
          <p class="muted">Trusted Vehicles, Smart Deals</p>
        </div>
        <div>
          <h4>Company</h4>
          <a href="about.html">About Us</a>
          <a href="contact.html">Contact Us</a>
        </div>
        <div>
          <h4>Legal</h4>
          <a href="terms.html">Terms &amp; Conditions</a>
          <a href="privacy.html">Privacy Policy</a>
          <a href="disclaimer.html">Disclaimer</a>
        </div>
        <div>
          <h4>Explore</h4>
          <a href="buy.html">Buy</a>
          <a href="sell.html">Sell</a>
          <a href="valuation.html">Valuation</a>
          <a href="tools.html">Tools</a>
        </div>
      </div>
      <div class="muted" style="padding:8px 0 20px">© <span id="yr"></span> Second Wheel — All rights reserved.</div>
    </div>
  </footer>

  <!-- WhatsApp Float -->
  <div class="wa"><a href="https://wa.me/919822292955" target="_blank" rel="noopener">WhatsApp</a></div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // Year
    document.getElementById('yr').textContent = new Date().getFullYear();

    // Dark mode
    const darkBtn = document.getElementById('darkBtn');
    const DARK_KEY='sw.dark';
    function applyDark(v){
      document.documentElement.style.colorScheme = v?'dark':'light';
      localStorage.setItem(DARK_KEY, v?'1':'0');
      darkBtn.textContent = v ? '🌙' : '☀️';
    }
    applyDark(localStorage.getItem(DARK_KEY)==='1');
    darkBtn.addEventListener('click', ()=>applyDark(!(localStorage.getItem(DARK_KEY)==='1')));

    // Simple i18n
    const I18N = {
      en:{'nav.home':'Home','nav.buy':'Buy','nav.sell':'Sell','nav.valuation':'Valuation','nav.tools':'Tools',
          'feat.title':'Featured Vehicles','feat.viewall':'View all','tools.title':'Tools & Services'},
      hi:{'nav.home':'होम','nav.buy':'खरीदें','nav.sell':'बेचें','nav.valuation':'वैल्यूएशन','nav.tools':'टूल्स',
          'feat.title':'फ़ीचर्ड वाहन','feat.viewall':'सभी देखें','tools.title':'टूल्स और सेवाएँ'},
      mr:{'nav.home':'मुखपृष्ठ','nav.buy':'खरेदी','nav.sell':'विक्री','nav.valuation':'मूल्यांकन','nav.tools':'साधने',
          'feat.title':'फीचर्ड वाहने','feat.viewall':'सर्व पाहा','tools.title':'टूल्स आणि सेवा'}
    };
    const langSeg=document.getElementById('langSeg');
    function applyLang(l){
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const k=el.getAttribute('data-i18n'); if(I18N[l] && I18N[l][k]) el.textContent = I18N[l][k];
      });
      [...langSeg.querySelectorAll('button')].forEach(b=>b.classList.toggle('active', b.dataset.lang===l));
      localStorage.setItem('sw.lang', l);
    }
    applyLang(localStorage.getItem('sw.lang')||'en');
    langSeg.addEventListener('click', e=>{ if(e.target.tagName==='BUTTON') applyLang(e.target.dataset.lang); });

    // Supabase Featured (with FULL description + buttons)
    const SUPABASE_URL='https://wbjwvxckbfkutqqbgupq.supabase.co';
    const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indiand2eGNrYmZrdXRxcWJndXBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NzU3NDEsImV4cCI6MjA2OTQ1MTc0MX0.u_zwikgAryhF5Ccv5yOvjq20hzxE5tbYfKI04uTnNXw';
    const BUCKET='vehicals';
    const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const featuredRow = document.getElementById('featuredRow');
    const purl = (path)=> sb.storage.from(BUCKET).getPublicUrl(path).data?.publicUrl || '';

    async function listSlugs(){
      const {data}=await sb.storage.from(BUCKET).list('featured',{limit:200});
      return (data||[]).filter(x=>x && !(/\./.test(x.name))).map(x=>x.name);
    }
    async function readMeta(slug){
      const {data}=await sb.storage.from(BUCKET).download(`featured/${slug}/meta.json`);
      if(!data) return null; try{ return JSON.parse(await data.text()); }catch{ return null; }
    }
    async function firstImg(slug){
      const {data}=await sb.storage.from(BUCKET).list(`featured/${slug}`,{limit:100});
      const f=(data||[]).find(o=>/\.(jpg|jpeg|png|webp)$/i.test(o.name));
      return f? purl(`featured/${slug}/${f.name}`) : '';
    }

    function cardHTML(m, img){
      const brand=(m.brand||'').toUpperCase();
      const metaLine=[m.year||'', m.km?`${m.km} km`:'' ].filter(Boolean).join(' • ');
      const desc=m.description||''; // FULL description
      const title=m.title || m.slug || 'Vehicle';
      const wa = `https://wa.me/919822292955?text=${encodeURIComponent('Inquiry: '+title)}`;
      return `
        <article class="card veh">
          <div class="media">
            ${img ? `<img src="${img}" alt="${title}">` : `<div style="height:220px;display:grid;place-items:center;color:#9aa3b2">No image</div>`}
            <span class="tag">Featured</span>
          </div>
          <div class="body">
            <div class="title">${title}</div>
            <div class="meta"><span>${brand}</span><strong>${m.price||''}</strong></div>
            <div class="meta"><span>${metaLine}</span><span>${(m.type||'').toUpperCase()}</span></div>
            ${desc ? `<p class="desc">${desc}</p>` : ``}
            <div class="actions">
              <a class="btn wish" href="wishlist.html#${m.slug||''}">♡ Wishlist</a>
              <a class="btn inq" target="_blank" rel="noopener" href="${wa}">Inquiry Now</a>
            </div>
          </div>
        </article>`;
    }

    async function loadFeatured(){
      featuredRow.innerHTML='<div class="muted">Loading…</div>';
      const slugs = await listSlugs();
      if(!slugs.length){ featuredRow.innerHTML='<div class="muted">No items yet</div>'; return; }
      const entries=[];
      for(const s of slugs){
        const [meta,img]=await Promise.all([readMeta(s), firstImg(s)]);
        if(meta) entries.push({meta:{...meta, slug:s}, img});
      }
      // newest first if updatedAt exists
      entries.sort((a,b)=> (b.meta.updatedAt||'').localeCompare(a.meta.updatedAt||''));
      featuredRow.innerHTML = entries.map(x=>cardHTML(x.meta,x.img)).join('');
    }
    loadFeatured();
  </script>
</body>
</html>
